<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>For Shreya ğŸ’˜</title>

  <style>
    :root{
      --bg1:#fff1f6;
      --bg2:#ffe6f1;
      --card:#ffffffde;
      --text:#1f1f1f;
      --pink:#ff2f7d;
      --pink2:#ff7fb4;
      --shadow: 0 22px 70px rgba(255,47,125,.22);
      --border: 1px solid rgba(0,0,0,.06);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      min-height:100vh;
      display:grid;
      place-items:center;
      overflow:hidden;
      background:
        radial-gradient(1200px 800px at 12% 12%, #ffd2e6 0%, transparent 55%),
        radial-gradient(1000px 700px at 88% 35%, #ffe9f2 0%, transparent 60%),
        linear-gradient(135deg,var(--bg1),var(--bg2));
    }

    .heart{
      position:absolute;
      width:16px;height:16px;
      transform: rotate(45deg);
      background: rgba(255,47,125,.18);
      border-radius:4px;
      animation: floatUp 11s linear infinite;
      opacity:.75;
      pointer-events:none;
      z-index:0;
    }
    .heart:before,.heart:after{
      content:"";
      position:absolute;
      width:16px;height:16px;
      background: inherit;
      border-radius:50%;
    }
    .heart:before{ left:-8px; top:0;}
    .heart:after{ top:-8px; left:0;}
    @keyframes floatUp{
      from{ transform: translateY(30vh) rotate(45deg); }
      to{ transform: translateY(-120vh) rotate(45deg); }
    }

    .floatWord{
      position:absolute;
      font-weight:900;
      letter-spacing:-.02em;
      padding:8px 12px;
      border-radius:999px;
      border: 1px solid rgba(255,47,125,.18);
      background: rgba(255,255,255,.55);
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 26px rgba(255,47,125,.10);
      color: rgba(31,31,31,.72);
      pointer-events:none;
      user-select:none;
      white-space:nowrap;
      transform: translate(-50%,-50%);
      opacity:.95;
      animation: drift 16s linear infinite;
      font-size: 13px;
      z-index:1;
    }
    .floatWord b{ color: rgba(255,47,125,.95); }
    @keyframes drift{
      0%   { transform: translate(-50%,-50%) translateY(30vh); opacity:0; }
      10%  { opacity:.95; }
      100% { transform: translate(-50%,-50%) translateY(-120vh); opacity:0; }
    }

    .wrap{
      width:min(980px, 94vw);
      padding:22px;
      position:relative;
      z-index:2;
    }
    .card{
      background:var(--card);
      border:1px solid rgba(255,255,255,.6);
      border-radius:28px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(12px);
      padding:22px 18px;
      position:relative;
      overflow:hidden;
    }

    .top{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:10px;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background: rgba(255,47,125,.10);
      border:1px solid rgba(255,47,125,.18);
      font-weight:900;
      font-size:13px;
    }
    .progress{
      font-size:13px;
      opacity:.75;
      white-space:nowrap;
    }

    h1{
      margin:10px 0 8px;
      font-size: clamp(22px, 4vw, 34px);
      letter-spacing:-.02em;
      line-height:1.12;
    }
    p{
      margin:8px 0;
      font-size:15.5px;
      line-height:1.7;
      opacity:.95;
    }

    .scene{ display:none; animation: in .45s ease; }
    .scene.active{ display:block; }
    @keyframes in{ from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }

    .pillrow{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top:10px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      background: rgba(255,47,125,.09);
      border:1px solid rgba(255,47,125,.16);
      font-size:13px;
      font-weight:900;
      color: rgba(31,31,31,.86);
    }

    .bubble{
      background: rgba(255,255,255,.78);
      border:var(--border);
      border-radius:18px;
      padding:14px;
      margin-top:14px;
      box-shadow: 0 10px 22px rgba(0,0,0,.04);
    }

    .note{
      margin-top:14px;
      padding:12px 14px;
      border-radius:16px;
      background: rgba(255,47,125,.07);
      border:1px solid rgba(255,47,125,.14);
    }

    .media{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:center;
      margin-top:12px;
    }
    .media img{
      width: min(380px, 88vw);
      border-radius:18px;
      border: var(--border);
      box-shadow: 0 12px 26px rgba(0,0,0,.10);
      object-fit:cover;
    }
    .caption{
      text-align:center;
      font-size:12.5px;
      opacity:.72;
      margin-top:8px;
    }

    .nav{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:16px;
      align-items:center;
      justify-content:space-between;

      position: sticky;
      bottom: 12px;
      background: rgba(255,255,255,.78);
      border: var(--border);
      border-radius: 18px;
      padding: 10px;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 22px rgba(0,0,0,.06);
      z-index: 5;
    }
    .navTop{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top:10px;
      align-items:center;
      justify-content:space-between;
    }

    button{
      border:0;
      border-radius:16px;
      padding:12px 14px;
      font-weight:950;
      cursor:pointer;
      transition: transform .12s ease, filter .12s ease;
      user-select:none;
    }
    button:hover{ transform: translateY(-1px); filter: brightness(1.02); }

    .btn{
      background: linear-gradient(135deg, var(--pink), var(--pink2));
      color:white;
      box-shadow: 0 12px 24px rgba(255,47,125,.22);
    }
    .btn2{
      background: rgba(0,0,0,.06);
      color:#333;
    }

    .yesArea{
      margin-top:16px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      align-items:center;
    }
    .no-wrap{ position:relative; display:inline-block; }

    .sparkle{
      position:absolute;
      pointer-events:none;
      width:10px;height:10px;
      border-radius:50%;
      background: rgba(255,47,125,.7);
      transform: translate(-50%,-50%);
      animation: pop .55s ease-out forwards;
      filter: blur(.2px);
      z-index:999;
    }
    @keyframes pop{
      0%{ opacity:0; transform: translate(-50%,-50%) scale(.6); }
      20%{ opacity:1; }
      100%{ opacity:0; transform: translate(-50%,-70%) scale(1.6); }
    }

    .poem{ line-height:1.9; font-size:15px; }
    .poem p{ margin: 12px 0; }

    .musicPill{
      position:fixed;
      right:14px;
      bottom:14px;
      z-index:10;
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:999px;
      background: rgba(255,255,255,.78);
      border: var(--border);
      box-shadow: 0 10px 22px rgba(0,0,0,.10);
      backdrop-filter: blur(10px);
    }
    .musicDot{
      width:10px;height:10px;border-radius:50%;
      background: rgba(255,47,125,.9);
      box-shadow: 0 0 0 6px rgba(255,47,125,.12);
      opacity:.45;
    }
    .musicLabel{
      font-size:12.5px;
      font-weight:900;
      opacity:.85;
      white-space:nowrap;
    }
    .musicBtn{
      padding:10px 12px;
      border-radius:999px;
      font-weight:950;
    }

    audio{ width:100%; max-width:360px; }

    .bigheart{
      font-size:54px;
      display:inline-block;
      animation: thump 1.2s ease-in-out infinite;
      filter: drop-shadow(0 10px 18px rgba(255,47,125,.18));
      margin:6px 0 2px;
    }
    @keyframes thump{ 0%,100%{transform:scale(1)} 50%{transform:scale(1.08)} }

    .tinyHint{ margin-top:10px; font-size:12.5px; opacity:.72; }
  </style>
</head>

<body>
  <script>
    const heartCount = 18;
    for(let i=0;i<heartCount;i++){
      const h=document.createElement('div');
      h.className='heart';
      h.style.left = Math.random()*100+'vw';
      h.style.animationDuration = (8+Math.random()*10)+'s';
      h.style.animationDelay = (-Math.random()*14)+'s';
      const s = 10 + Math.random()*18;
      h.style.width = s+'px';
      h.style.height = s+'px';
      h.style.opacity = 0.25 + Math.random()*0.45;
      document.body.appendChild(h);
    }
  </script>

  <audio id="bgm" loop preload="none"></audio>

  <div class="musicPill" aria-label="music control">
    <div class="musicDot" id="musicDot"></div>
    <div class="musicLabel" id="musicLabel">Music: Off</div>
    <button class="btn2 musicBtn" id="musicToggle">Play</button>
  </div>

  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="badge">ğŸ’Œ For <span id="herName"></span></div>
        <div class="progress" id="progress"></div>
      </div>

      <div id="scenes"></div>
    </div>
  </div>

  <script>
    // ===== Customize =====
    const NAME = "Shreya";

    // Put these files in the SAME folder as index.html (repo root).
    // IMPORTANT: GitHub Pages is case-sensitive.
    // Your photo is us.JPG, so we include it here.
    const PHOTO_CANDIDATES = ["us.JPG", "us.jpg", "us.jpeg", "us.png", "us.JPEG", "us.PNG"];
    const VOICE_CANDIDATES = ["shreya.mp3", "shreya.m4a"];
    const MUSIC_FILE = "music.mp3";
    // =====================

    document.getElementById("herName").textContent = NAME;

    const CB = `?v=${Date.now()}`; // cache buster

    // --- music ---
    const bgm = document.getElementById("bgm");
    bgm.src = MUSIC_FILE + CB;

    const musicToggle = document.getElementById("musicToggle");
    const musicLabel  = document.getElementById("musicLabel");
    const musicDot    = document.getElementById("musicDot");

    function setMusicUI(isOn){
      musicLabel.textContent = "Music: " + (isOn ? "On" : "Off");
      musicToggle.textContent = isOn ? "Pause" : "Play";
      musicDot.style.opacity = isOn ? "1" : ".45";
    }
    setMusicUI(false);

    async function tryPlayMusic(){
      try{
        await bgm.play();
        localStorage.setItem("bgm_on","1");
        setMusicUI(true);
      }catch(e){
        setMusicUI(false);
      }
    }
    function pauseMusic(){
      bgm.pause();
      localStorage.setItem("bgm_on","0");
      setMusicUI(false);
    }
    musicToggle.addEventListener("click", async ()=>{
      if(bgm.paused) await tryPlayMusic();
      else pauseMusic();
    });

    // --- floating nickname words (Chaakey!) ---
    const nicknames = [
      {t:"Chaakey", e:"ğŸ’˜"},
      {t:"Sanu", e:"ğŸŒ™"},
      {t:"Baby", e:"ğŸ’‹"},
      {t:"Mrs Thapa", e:"ğŸŒ¹"},
      {t:"Chaakey", e:"ğŸ«‚"},
      {t:"Sanu", e:"ğŸ’"},
      {t:"Baby", e:"ğŸ«"},
      {t:"Mrs Thapa", e:"ğŸ§¸"},
      {t:"Chaakey", e:"ğŸ˜˜"},
      {t:"Sanu", e:"â¤ï¸"},
      {t:"Baby", e:"ğŸŒ¹"},
      {t:"Mrs Thapa", e:"ğŸ’—"},
      {t:"Chaakey", e:"ğŸ«¶"},
      {t:"Sanu", e:"ğŸŒ¸"}
    ];

    function spawnWord(){
      const w = document.createElement("div");
      w.className = "floatWord";
      const pick = nicknames[Math.floor(Math.random()*nicknames.length)];
      w.style.left = (6 + Math.random()*88) + "vw";
      w.style.top  = (70 + Math.random()*25) + "vh";
      const size = 12 + Math.random()*6;
      w.style.fontSize = size + "px";
      const dur = 12 + Math.random()*10;
      w.style.animationDuration = dur + "s";
      w.style.animationDelay = (-Math.random()*dur) + "s";
      w.style.opacity = (0.75 + Math.random()*0.25).toFixed(2);
      w.innerHTML = `<b>${pick.t}</b> ${pick.e}`;
      document.body.appendChild(w);
      setTimeout(()=>w.remove(), (dur+2)*1000);
    }
    for(let i=0;i<10;i++) spawnWord();
    setInterval(spawnWord, 1200);

    function sparkle(x,y){
      const s=document.createElement('div');
      s.className='sparkle';
      s.style.left = x+'px';
      s.style.top = y+'px';
      document.body.appendChild(s);
      setTimeout(()=>s.remove(), 600);
    }

    async function pickFirstWorking(candidates){
      for(const f of candidates){
        try{
          const r = await fetch(f + CB, { method:"HEAD", cache:"no-store" });
          if(r.ok) return f;
        }catch(e){}
      }
      return candidates[0];
    }

    function tplScene({title, dayLabel="", pills=[], bodyHTML="", showPhoto=false, showVoice=false, final=false, isPoem=false, showNav=true}) {
      const wrap = document.createElement("div");
      wrap.className = "scene";

      const dayHTML = dayLabel ? `<div class="pillrow"><div class="pill">${dayLabel}</div></div>` : "";
      const pillsHTML = pills.length ? `<div class="pillrow">${pills.map(t=>`<div class="pill">${t}</div>`).join("")}</div>` : "";
      const poemTopNav = isPoem ? `
        <div class="navTop">
          <button class="btn2" id="prevBtnTop">â† Back</button>
          <button class="btn" id="nextBtnTop">Next â†’</button>
        </div>
      ` : "";

      const photoHTML = showPhoto ? `
        <div class="media">
          <img id="coupleImg" src="" alt="us" loading="lazy">
        </div>
        <div class="caption" id="photoCap">This is my favorite photo. (Donâ€™t argue. I already decided.)</div>
        <div class="tinyHint" id="photoHint" style="display:none;"></div>
      ` : "";

      const voiceHTML = showVoice ? `
        <div class="bubble" style="margin-top:14px; text-align:center;">
          <p style="margin:0; font-weight:950;">Press play.</p>
          <p style="margin:6px 0 12px; opacity:.75;">And donâ€™t do that thing where you pretend youâ€™re not smiling.</p>
          <audio id="voiceAudio" controls preload="none"></audio>
          <div class="tinyHint" id="voiceHint" style="display:none;"></div>
        </div>
      ` : "";

      wrap.innerHTML = `
        <h1>${title}</h1>
        ${dayHTML}
        ${pillsHTML}
        ${poemTopNav}
        <div class="bubble">${bodyHTML}</div>
        ${voiceHTML}
        ${photoHTML}
        ${final ? `
          <div class="yesArea">
            <button class="btn" id="yesBtn">YES ğŸ’</button>
            <span class="no-wrap">
              <button class="btn2" id="noBtn">No ğŸ˜¶</button>
            </span>
          </div>
          <div class="caption" id="noHint">You can answer honestlyâ€¦ but that â€œNoâ€ button is scared of you.</div>
        ` : (showNav ? `
          <div class="nav">
            <button class="btn2" id="prevBtn">â† Back</button>
            <button class="btn" id="nextBtn">Next â†’</button>
          </div>
        ` : ``)}
      `;
      return wrap;
    }

    const PAGES = [
      {
        title: `Hi ${NAME}â€¦ ğŸ¥ºğŸ‘‰ğŸ‘ˆ`,
        dayLabel: "Okay justâ€¦ read this ğŸ’—",
        pills: ["Chaakey", "Sanu", "Baby", "Mrs Thapa"],
        bodyHTML: `
          <p>Soâ€¦ I made a khatra kuraa duee ghanta laayera.</p>
          <p>Not because itâ€™s Valentine week or whatever.</p>
          <p>Because I miss you. And because youâ€™re cute. And because Iâ€™m in love with you and I donâ€™t know how to behave properly.</p>
          <div class="note">
            <p style="margin:0;">
              Go page by page. Take your time.<br>
              And if you laugh, donâ€™t fight it. ğŸ˜Œ
            </p>
          </div>
          <p style="opacity:.85; margin-top:12px;">(Music button is down there if you want vibes.)</p>
        `
      },
      {
        title: "Rose Day ğŸŒ¹",
        dayLabel: "Rose Day",
        bodyHTML: `
          <p>If I was next to you right now, Iâ€™d give you a rose.</p>
          <p>Then Iâ€™d stare at you like I forgot how to talk. (Because you do that to me.)</p>
          <p>So hereâ€™s your rose from far away: ğŸŒ¹</p>
          <p>And yes, youâ€™re still my favorite person. Likeâ€¦ annoyingly favorite.</p>
        `
      },
      {
        title: "Propose Day ğŸ’",
        dayLabel: "Propose Day",
        bodyHTML: `
          <p>Not a big public proposal. No crowd. No cringe.</p>
          <p>Just me saying: I want you.</p>
          <p>In the normal days. In the sleepy days. In the yametto gododsai konichiwa konichiwa days. In the aawaaz bujhena days. In the â€œI miss you so muchâ€ days.</p>
          <p>So yeahâ€¦ Iâ€™m proposing we keep being us. Always. ğŸ˜ŒğŸ’—</p>
        `
      },
      {
        title: "Chocolate Day ğŸ«",
        dayLabel: "Chocolate Day",
        bodyHTML: `
          <p>I would absolutely bring you chocolate in real life.</p>
          <p>And then I would steal one piece and act innocent.</p>
          <p>Anyway â€” eat something sweet that day.</p>
          <p>If you donâ€™t, Iâ€™ll still love youâ€¦ but Iâ€™ll be personally offended on behalf of romance.</p>
        `
      },
      {
        title: "Teddy Day ğŸ§¸",
        dayLabel: "Teddy Day",
        bodyHTML: `
          <p>Iâ€™m not saying I will buy you a teddy.</p>
          <p>Iâ€™m just sayingâ€¦ if I could be the thing you hug at night, I would be that thing immediately.</p>
          <p>Also Iâ€™m jealous of your pillow ğŸ˜‰. That one is true. No apology.</p>
          <p>Miss you, Sanu.</p>
        `
      },
      {
        title: "Promise Day ğŸ¤",
        dayLabel: "Promise Day",
        bodyHTML: `
          <p>I donâ€™t have movie promises.</p>
          <p>I have real ones:</p>
          <p>
            â€¢ Iâ€™ll keep choosing you.<br>
            â€¢ Iâ€™ll keep showing up (even from far).<br>
            â€¢ Iâ€™ll keep being gentle with you.<br>
            â€¢ Iâ€™ll keep making you laugh when youâ€™re annoyed at me.
          </p>
          <p>Alsoâ€¦ our best memories are locked in my brain forever: first date, full moon at Patan Mandir, momo in Patan ko Galli. ğŸ¥ŸğŸŒ™</p>
        `
      },

      { title:"ğŸŒ™", pills:["(just read)"], isPoem:true, bodyHTML: `
        <p style="opacity:.85; font-style:italic; margin-top:0;">Iâ€™m not explaining this. Iâ€™m just leaving it here.</p>
        <div class="poem">
          <p>If only I could own my dreams,<br>
          With sleepless night, I would trade all of it.<br>
          Telling the birds to sleep early and quiet,<br>
          Even the leaves wouldnâ€™t make any noise.</p>

          <p>And here I hold my breath all so tight<br>
          For listening you breathe all whole night</p>

          <p>If morning were endless<br>
          And you drizzle like rain</p>
        </div>
      `},
      { title:"ğŸŒ™", pills:["(keep going)"], isPoem:true, bodyHTML: `
        <div class="poem">
          <p>I could be an ocean receiving all your pain.</p>

          <p>Let the pain move like waves between shores of our souls<br>
          And embrace each other until it utterly goes</p>

          <p>Unite our soul, make it whole and make those pain never shows again<br>
          And tell our tale to the clouds as they listen cravingly, the pelting rain</p>

          <p>The worst things about mornings and nights,<br>
          They always end</p>
        </div>
      `},
      { title:"ğŸŒ™", pills:["(last part)"], isPoem:true, bodyHTML: `
        <div class="poem">
          <p>I pass the time in between, counting hours, till comes the another night<br>
          My heart, I love you with all my soul and with all my might</p>

          <p>Among all the loveliest things, you are the only one precious, I have.<br>
          For length of my love is far greater than length of my life</p>

          <p>Give me a little of you dear, and I will give you all of mine</p>

          <p>If I could stop my heart from loving you<br>
          Then I shall remain heartless<br>
          For thereâ€™s nothing I would rather do<br>
          Than spending my whole life loving only you.</p>
        </div>
      `},

      {
        title: "Hug Day ğŸ«‚",
        dayLabel: "Hug Day",
        bodyHTML: `
          <p>I miss you in a very specific way.</p>
          <p>Likeâ€¦ I want to hug you and not talk for a minute. Just exist.</p>
          <div class="note">
            <p style="margin:0;">
              Hug protocol:<br>
              1) close your eyes<br>
              2) imagine Iâ€™m hugging you<br>
              3) imagine I refuse to let go<br>
              4) yes, youâ€™re stuck. sorry. ğŸ«‚
            </p>
          </div>
          <p>Distance is annoying. You are not.</p>
        `
      },
      {
        title: "Kiss Day ğŸ’‹",
        dayLabel: "Kiss Day",
        bodyHTML: `
          <p>I owe you kisses. A lot.</p>
          <p>But first we must talk about the historic moment:</p>
          <p><b>the day I didnâ€™t eat ice-cream through your mouth.</b></p>
          <p>I still donâ€™t know what happened in my brain. Fear? Respect? Survival instinct? Probably all three. ğŸ˜­</p>
          <p>You were mad. I was confused. We were iconic.</p>
          <p>Anywayâ€¦ sending you a kiss that says â€œI love youâ€ and also â€œplease donâ€™t bring ice-cream near my face like that again.â€</p>
        `
      },
      {
        title: `${NAME}â€¦ ğŸ’˜`,
        dayLabel: "Valentine",
        pills: ["Chaakey", "Sanu", "Baby", "Mrs Thapa"],
        showVoice: true,
        showPhoto: true,
        final: true,
        bodyHTML: `
          <p>I donâ€™t have a list of reasons.</p>
          <p>I just love you.</p>
          <p>Like the simple kind that stays. The kind that makes me miss you even when Iâ€™m busy. The kind that feels safe.</p>
          <div class="note">
            <p style="margin:0; font-weight:950;">Will you be my Valentine? ğŸŒ¹</p>
          </div>
          <p class="caption"><span class="bigheart">ğŸ’˜</span></p>
        `
      },
      {
        title: "Okay thenâ€¦ ğŸ˜ŒğŸ’‹",
        showNav:false,
        bodyHTML: `
          <p>So itâ€™s official.</p>
          <p>You said yes.</p>
          <div class="note">
            <p style="margin:0; font-weight:950; font-size:18px;">
              chaak dey malai aba.
            </p>
          </div>
          <p style="opacity:.9; margin-top:12px;">(Iâ€™m kidding. Mostly.)</p>
        `
      }
    ];

    const scenesEl = document.getElementById("scenes");
    const progressEl = document.getElementById("progress");

    const nodes = PAGES.map(p => tplScene({
      title: p.title,
      dayLabel: p.dayLabel || "",
      pills: p.pills || [],
      bodyHTML: p.bodyHTML || "",
      showPhoto: !!p.showPhoto,
      showVoice: !!p.showVoice,
      final: !!p.final,
      isPoem: !!p.isPoem,
      showNav: (p.showNav !== false)
    }));

    nodes.forEach(n => scenesEl.appendChild(n));

    let idx = 0;

    function updateProgress(){
      progressEl.textContent = `${idx+1} / ${PAGES.length}`;
    }

    function bindNav(active){
      const prev = active.querySelector("#prevBtn");
      const next = active.querySelector("#nextBtn");
      if(prev) prev.onclick = (e)=>{ sparkle(e.clientX, e.clientY); show(idx-1); };
      if(next) next.onclick = (e)=>{ sparkle(e.clientX, e.clientY); show(idx+1); };

      const prevTop = active.querySelector("#prevBtnTop");
      const nextTop = active.querySelector("#nextBtnTop");
      if(prevTop) prevTop.onclick = (e)=>{ sparkle(e.clientX, e.clientY); show(idx-1); };
      if(nextTop) nextTop.onclick = (e)=>{ sparkle(e.clientX, e.clientY); show(idx+1); };
    }

    function bindFinal(active){
      const yes = active.querySelector("#yesBtn");
      const no  = active.querySelector("#noBtn");
      const hint = active.querySelector("#noHint");
      const wrap = active.querySelector(".no-wrap");

      let noDodges = 0;
      const noPhrases = [
        "Are you sure? ğŸ¥º",
        "Wait wait wait ğŸ˜­",
        "That option is suspiciousâ€¦",
        "Try again ğŸ˜Œ",
        "Okay butâ€¦ YES? ğŸ˜³",
        "Iâ€™m going to be softly sad ğŸ˜”",
        "Thatâ€™s illegal ğŸš”ğŸ’˜",
        "Universe says no ğŸŒŒ",
        "Please ğŸ¥¹",
        "Last chance ğŸ“"
      ];

      function dodge(){
        noDodges++;
        if(hint) hint.textContent = noPhrases[Math.min(noDodges-1, noPhrases.length-1)];
        const cardRect = document.querySelector(".card").getBoundingClientRect();
        const maxX = Math.max(0, Math.min(220, cardRect.width - 180));
        const maxY = 50;

        const x = (Math.random()*maxX) - (maxX/2);
        const y = (Math.random()*maxY) - (maxY/2);

        if(wrap){
          wrap.style.transform = `translate(${x}px, ${y}px)`;
          wrap.style.transition = "transform .12s ease";
        }

        if(noDodges >= 10 && no) no.textContent = "Iâ€™m shy ğŸ™ˆ";
        if(noDodges >= 14 && no){
          no.textContent = "Okay fineâ€¦ click me";
          no.removeEventListener("mouseenter", dodge);
          no.removeEventListener("touchstart", dodge);
        }
      }

      if(yes){
        yes.onclick = async (e)=>{
          sparkle(e.clientX, e.clientY);
          if(localStorage.getItem("bgm_on") === "1" && bgm.paused) await tryPlayMusic();
          show(PAGES.length - 1);
        };
      }
      if(no){
        no.addEventListener("mouseenter", dodge);
        no.addEventListener("touchstart", (e)=>{ e.preventDefault(); dodge(); }, {passive:false});
        no.onclick = (e)=>{ sparkle(e.clientX, e.clientY); alert("Nice try ğŸ˜Œ"); };
      }
    }

    async function fixMediaForScene(active){
      const img = active.querySelector("#coupleImg");
      const photoHint = active.querySelector("#photoHint");
      if(img){
        const chosen = await pickFirstWorking(PHOTO_CANDIDATES);
        let i = PHOTO_CANDIDATES.indexOf(chosen);
        if(i < 0) i = 0;

        function setSrc(file){ img.src = file + CB; }
        function tryNext(){
          i++;
          if(i < PHOTO_CANDIDATES.length){
            setSrc(PHOTO_CANDIDATES[i]);
          }else if(photoHint){
            photoHint.style.display = "block";
            photoHint.textContent =
              "Photo didnâ€™t load. Make sure the file is in the repo root and named exactly (case matters): us.JPG";
          }
        }
        setSrc(PHOTO_CANDIDATES[i]);
        img.onerror = tryNext;
      }

      const audio = active.querySelector("#voiceAudio");
      const voiceHint = active.querySelector("#voiceHint");
      if(audio){
        audio.innerHTML = `
          <source src="${VOICE_CANDIDATES[0] + CB}" type="audio/mpeg">
          <source src="${VOICE_CANDIDATES[1] + CB}" type="audio/mp4">
        `;
        audio.addEventListener("error", () => {
          if(voiceHint){
            voiceHint.style.display = "block";
            voiceHint.textContent =
              "Voice note didnâ€™t load. Make sure itâ€™s shreya.mp3 or shreya.m4a in the repo root (case matters).";
          }
        });
      }
    }

    function show(i){
      idx = Math.max(0, Math.min(i, nodes.length-1));
      document.querySelectorAll(".scene").forEach(s => s.classList.remove("active"));
      const active = nodes[idx];
      active.classList.add("active");

      updateProgress();
      bindNav(active);
      bindFinal(active);
      fixMediaForScene(active);

      window.scrollTo({top:0, behavior:"smooth"});
    }

    show(0);
  </script>
</body>
</html>
